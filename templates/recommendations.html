{% extends 'base.html' %}

{% block title %}Recommendations - Energy Anomaly Detection{% endblock %}

{% block content %}
<div class="row mt-4">
    <div class="col-12">
        <h1 class="page-header">
            <i class="fas fa-clipboard-list me-2"></i> Energy Efficiency Recommendations
        </h1>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-lightbulb me-2"></i> Recommendation Summary
                </h5>
            </div>
            <div class="card-body">
                {% if has_analysis %}
                <div class="alert alert-primary">
                    <i class="fas fa-info-circle me-2"></i> Based on our analysis of your energy consumption data, we've identified several potential areas for improvement.
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i> General energy efficiency recommendations are shown below. Upload data and run anomaly detection for personalized recommendations.
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Recommendations Content -->
<div class="row">
    <!-- Main Recommendations -->
    <div class="col-lg-8">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-star me-2"></i> Key Recommendations
                </h5>
            </div>
            <div class="card-body">
                {% if has_analysis %}
                <div class="mb-4">
                    <h5 class="border-bottom pb-2 text-primary">Anomaly Analysis Results</h5>
                    <p>We detected {{ analysis.anomaly_count }} anomalies in your energy consumption data. Here are our specific recommendations:</p>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-exclamation-circle me-2" style="color: var(--danger);"></i>
                            <h6 class="mb-0">Investigate Unusual Consumption Patterns</h6>
                        </div>
                        <p>We observed unusual energy consumption patterns that may indicate equipment inefficiencies or failures.</p>
                        <div class="ps-4">
                            <p><strong>Recommended Action:</strong> Investigate the energy consumption during these identified periods:</p>
                            <ul>
                                <li>Check for equipment that was operating during anomaly periods</li>
                                <li>Verify settings on energy-intensive systems</li>
                                <li>Look for correlations with external factors (weather, occupancy)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-clock me-2" style="color: var(--warning);"></i>
                            <h6 class="mb-0">Optimize Operation Schedules</h6>
                        </div>
                        <p>Your energy usage shows potential for optimization by adjusting operation schedules.</p>
                        <div class="ps-4">
                            <p><strong>Recommended Action:</strong> Consider the following schedule adjustments:</p>
                            <ul>
                                <li>Shift energy-intensive operations to off-peak hours</li>
                                <li>Implement automated controls for equipment shutdown during non-use periods</li>
                                <li>Review and adjust temperature setbacks during unoccupied periods</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-tools me-2" style="color: var(--primary);"></i>
                            <h6 class="mb-0">Maintenance and Equipment Upgrade</h6>
                        </div>
                        <p>Some anomalies may indicate equipment that is not operating at optimal efficiency.</p>
                        <div class="ps-4">
                            <p><strong>Recommended Action:</strong> Consider these maintenance and upgrade options:</p>
                            <ul>
                                <li>Schedule preventive maintenance for equipment showing abnormal consumption</li>
                                <li>Consider upgrading older equipment with more energy-efficient models</li>
                                <li>Implement real-time monitoring for early detection of future anomalies</li>
                            </ul>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="mb-4">
                    <h5 class="border-bottom pb-2 text-primary">General Energy Efficiency Recommendations</h5>
                    <p>Based on common energy efficiency practices, here are some general recommendations:</p>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-lightbulb me-2" style="color: var(--warning);"></i>
                            <h6 class="mb-0">Lighting Systems</h6>
                        </div>
                        <div class="ps-4">
                            <ul>
                                <li>Replace conventional lighting with LED technology</li>
                                <li>Install occupancy sensors in less frequently used areas</li>
                                <li>Maximize natural lighting where possible</li>
                                <li>Implement daylight harvesting systems in areas with good natural light</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-temperature-high me-2" style="color: var(--danger);"></i>
                            <h6 class="mb-0">HVAC Systems</h6>
                        </div>
                        <div class="ps-4">
                            <ul>
                                <li>Upgrade to high-efficiency HVAC equipment</li>
                                <li>Install programmable thermostats with setback capabilities</li>
                                <li>Ensure regular maintenance of filters and mechanical components</li>
                                <li>Consider variable frequency drives for large motors</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="recommendation-item mb-4">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-plug me-2" style="color: var(--primary);"></i>
                            <h6 class="mb-0">Equipment and Plug Loads</h6>
                        </div>
                        <div class="ps-4">
                            <ul>
                                <li>Use ENERGY STAR rated equipment where available</li>
                                <li>Implement power management settings on electronic devices</li>
                                <li>Use smart power strips to eliminate phantom loads</li>
                                <li>Consider energy-efficient alternatives when replacing equipment</li>
                            </ul>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <div class="mb-4">
                    <h5 class="border-bottom pb-2 text-primary">Next Steps for Improvement</h5>
                    <ol>
                        <li>Prioritize recommendations based on potential energy savings and implementation cost</li>
                        <li>Develop an implementation timeline for selected measures</li>
                        <li>Establish a monitoring system to track improvements in energy efficiency</li>
                        <li>Continue to analyze energy data regularly to identify new anomalies and opportunities</li>
                    </ol>
                </div>
                
                <div class="alert alert-success">
                    <i class="fas fa-check-circle me-2"></i> 
                    <strong>Estimated Impact:</strong> Implementing these recommendations could potentially reduce energy consumption by 10-30%, depending on your current operational efficiency.
                </div>
            </div>
        </div>
    </div>
    
    <!-- Sidebar Content -->
    <div class="col-lg-4">
        <!-- Energy Efficiency Rating Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-pie me-2"></i> Energy Efficiency Rating
                </h5>
            </div>
            <div class="card-body text-center">
                <div class="mb-3">
                    {% if has_analysis %}
                        {% if analysis.anomaly_count > 10 %}
                            <div class="display-1 text-danger">C</div>
                            <p>Significant improvement potential</p>
                        {% elif analysis.anomaly_count > 5 %}
                            <div class="display-1 text-warning">B</div>
                            <p>Moderate efficiency - Some improvements needed</p>
                        {% else %}
                            <div class="display-1 text-success">A</div>
                            <p>High efficiency - Minor improvements possible</p>
                        {% endif %}
                    {% else %}
                        <div class="display-1 text-info">?</div>
                        <p>Upload data to receive a rating</p>
                    {% endif %}
                </div>
                
                {% if not has_analysis %}
                <div class="mt-3">
                    <a href="{{ url_for('upload') }}" class="btn btn-primary">
                        <i class="fas fa-upload me-2"></i> Upload Data
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
        
        <!-- Energy Saving Tips Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-leaf me-2"></i> Quick Energy Saving Tips
                </h5>
            </div>
            <div class="card-body">
                <div class="tip-item mb-3">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-lightbulb fa-2x" style="color: var(--warning);"></i>
                        </div>
                        <div>
                            <h6>Switch to LED Lighting</h6>
                            <p class="mb-0">LED lights use up to 75% less energy and last 25 times longer than incandescent lighting.</p>
                        </div>
                    </div>
                </div>
                
                <div class="tip-item mb-3">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-thermometer-half fa-2x" style="color: var(--primary);"></i>
                        </div>
                        <div>
                            <h6>Optimize Temperature Settings</h6>
                            <p class="mb-0">Adjusting your thermostat by just 1-2 degrees can reduce energy use by up to 10%.</p>
                        </div>
                    </div>
                </div>
                
                <div class="tip-item mb-3">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-power-off fa-2x" style="color: var(--danger);"></i>
                        </div>
                        <div>
                            <h6>Eliminate Standby Power</h6>
                            <p class="mb-0">Standby power can account for 5-10% of residential electricity use.</p>
                        </div>
                    </div>
                </div>
                
                <div class="tip-item">
                    <div class="d-flex">
                        <div class="me-3">
                            <i class="fas fa-chart-line fa-2x" style="color: var(--success);"></i>
                        </div>
                        <div>
                            <h6>Regular Monitoring</h6>
                            <p class="mb-0">Continuous monitoring can help identify new energy-saving opportunities.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Call to Action Card -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-forward me-2"></i> Next Steps
                </h5>
            </div>
            <div class="card-body text-center">
                <p>Ready to improve your energy efficiency?</p>
                
                {% if has_analysis %}
                <a href="{{ url_for('detection') }}" class="btn btn-primary mb-2 w-100">
                    <i class="fas fa-search me-2"></i> Run Another Analysis
                </a>
                <a href="{{ url_for('results', analysis_id=analysis.id) }}" class="btn btn-outline-light w-100">
                    <i class="fas fa-chart-line me-2"></i> View Analysis Results
                </a>
                {% else %}
                <a href="{{ url_for('upload') }}" class="btn btn-primary mb-2 w-100">
                    <i class="fas fa-upload me-2"></i> Upload Energy Data
                </a>
                <a href="{{ url_for('detection') }}" class="btn btn-outline-light w-100">
                    <i class="fas fa-search me-2"></i> Run Anomaly Detection
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
